
mode: "managed"
account:
  address: "0x49e0fd3800C117357057534E30c5B5115C673488"
  salt: 15
  # deployer address: 0xA4D5208390Ce0d0EFF30239980B4a0439D730277

dependencies:
  - project: "token-faucet" # TokenFaucet: 0x746789E5B988e9dA56552fe6dE6eC671C01A2336
    required: true
  - project: "weth9" # WETH9: 0x2cE89A6c99B45d1b62c1c07cAF731bF12d88C293
    required: true
  - project: "tether" # TetherToken: 0x9DD32D4F511996EFff334B6f4c1229757b963AA2
    required: true
  - project: "usdc" # USDC: 0x675d653aFC71A433ca5586ed4d52e64b5FFFE787
    required: true
  - project: "uniswap-v3" # UniswapV3Factory: 0x15D38a36319c0525276E5D69BeFfA7aB4f55845A
    required: true

steps:
  - # create PoolLiquidityProvider (0x64deF03639e9cC87c93d266c90010D17616F7318)
    action: "create"
    bytecode: "0x608060405234801561001057600080fd5b50604051610a3e380380610a3e83398101604081905261002f91610087565b600080546001600160a01b03199081163317909155600180546001600160a01b03948516908316179055600280549290931691161790556100ba565b80516001600160a01b038116811461008257600080fd5b919050565b6000806040838503121561009a57600080fd5b6100a38361006b565b91506100b16020840161006b565b90509250929050565b610975806100c96000396000f3fe6080604052600436106100435760003560e01c8063150b7a021461004f5780631b8b921d14610099578063d6d2b6ba146100ae578063dd142777146100ce57600080fd5b3661004a57005b600080fd5b34801561005b57600080fd5b5061007b61006a366004610650565b630a85bd0160e11b95945050505050565b6040516001600160e01b031990911681526020015b60405180910390f35b6100ac6100a73660046106bf565b610109565b005b3480156100ba57600080fd5b506100ac6100c93660046106bf565b6101e0565b6100e16100dc366004610724565b610261565b604080519485526001600160801b039093166020850152918301526060820152608001610090565b6000546001600160a01b0316331461013c5760405162461bcd60e51b8152600401610133906107a6565b60405180910390fd5b6000836001600160a01b03163484846040516101599291906107c9565b60006040518083038185875af1925050503d8060008114610196576040519150601f19603f3d011682016040523d82523d6000602084013e61019b565b606091505b50509050806101da5760405162461bcd60e51b815260206004820152600b60248201526a18d85b1b0819985a5b195960aa1b6044820152606401610133565b50505050565b6000546001600160a01b0316331461020a5760405162461bcd60e51b8152600401610133906107a6565b6000836001600160a01b031683836040516102269291906107c9565b600060405180830381855af49150503d8060008114610196576040519150601f19603f3d011682016040523d82523d6000602084013e61019b565b600080548190819081906001600160a01b031633146102925760405162461bcd60e51b8152600401610133906107a6565b6002546001600160a01b038c81169116146102bf576001546102bf908c906001600160a01b0316886104eb565b6002546001600160a01b038b81169116146102ec576001546102ec908b906001600160a01b0316876104eb565b60408051610160810182526001600160a01b03808e1682528c8116602083015262ffffff8c168284015260028b810b60608401528a900b608083015260a0820189905260c08201889052600060e08301819052610100830181905230610120840152426101408401526001549351634418b22b60e11b81529293909283928392839291169063883164569034906103879089906004016107d9565b60806040518083038185885af11580156103a5573d6000803e3d6000fd5b50505050506040513d601f19601f820116820180604052508101906103ca919061089d565b9350935093509350600160009054906101000a90046001600160a01b03166001600160a01b03166312210e8a6040518163ffffffff1660e01b8152600401600060405180830381600087803b15801561042257600080fd5b505af1158015610436573d6000803e3d6000fd5b5050505060004711156104d557604051600090329047908381818185875af1925050503d8060008114610485576040519150601f19603f3d011682016040523d82523d6000602084013e61048a565b606091505b50509050806104d35760405162461bcd60e51b815260206004820152601560248201527419985a5b1959081d1bc81cd95b99081c99599d5b99605a1b6044820152606401610133565b505b929f919e509c50909a5098505050505050505050565b604080516001600160a01b038481166024830152604480830185905283518084039091018152606490920183526020820180516001600160e01b031663095ea7b360e01b179052915160009283929087169161054791906108e7565b6000604051808303816000865af19150503d8060008114610584576040519150601f19603f3d011682016040523d82523d6000602084013e610589565b606091505b50915091508180156105b35750805115806105b35750808060200190518101906105b39190610916565b6105e45760405162461bcd60e51b8152602060048201526002602482015261534160f01b6044820152606401610133565b5050505050565b80356001600160a01b038116811461060257600080fd5b919050565b60008083601f84011261061957600080fd5b50813567ffffffffffffffff81111561063157600080fd5b60208301915083602082850101111561064957600080fd5b9250929050565b60008060008060006080868803121561066857600080fd5b610671866105eb565b945061067f602087016105eb565b935060408601359250606086013567ffffffffffffffff8111156106a257600080fd5b6106ae88828901610607565b969995985093965092949392505050565b6000806000604084860312156106d457600080fd5b6106dd846105eb565b9250602084013567ffffffffffffffff8111156106f957600080fd5b61070586828701610607565b9497909650939450505050565b8035600281900b811461060257600080fd5b600080600080600080600060e0888a03121561073f57600080fd5b610748886105eb565b9650610756602089016105eb565b9550604088013562ffffff8116811461076e57600080fd5b945061077c60608901610712565b935061078a60808901610712565b925060a0880135915060c0880135905092959891949750929550565b6020808252600990820152683737ba1037bbb732b960b91b604082015260600190565b8183823760009101908152919050565b81516001600160a01b031681526101608101602083015161080560208401826001600160a01b03169052565b50604083015161081c604084018262ffffff169052565b506060830151610831606084018260020b9052565b506080830151610846608084018260020b9052565b5060a083015160a083015260c083015160c083015260e083015160e08301526101008084015181840152506101208084015161088c828501826001600160a01b03169052565b505061014092830151919092015290565b600080600080608085870312156108b357600080fd5b8451935060208501516001600160801b03811681146108d157600080fd5b6040860151606090960151949790965092505050565b6000825160005b8181101561090857602081860181015185830152016108ee565b506000920191825250919050565b60006020828403121561092857600080fd5b8151801515811461093857600080fd5b939250505056fea26469706673582212206ef0e36e67d29e6671e234858e2355b19456cbc61e2b2c5badf9cc5ecc53a9cf64736f6c63430008110033"
    constructor:
      abi: "constructor(address positionManager, address weth9)"
      args:
        - "0x{ref:uniswap-v3.NonfungiblePositionManager}"
        - "0x{ref:weth9.WETH9}"


  # USDT/WETH pool
  - # create & init pool
    action: "call"
    address: "0x{ref:uniswap-v3.NonfungiblePositionManager}"
    amount: 0
    call:
      abi: "function createAndInitializePoolIfNecessary(address token0, address token1, uint24 fee, uint160 sqrtPriceX96)"
      args:
        - "0x{ref:weth9.WETH9}"
        - "0x{ref:tether.TetherToken}"
        - "3000"
        - "0x2128422b231dc1486f5f3"
  - # request 1,000,000 USDT as PoolLiquidityProvider from TokenFaucet
    action: "call"
    address: "0x{create:1}"
    amount: "0x{ether:10000}" # 10000 ETH
    call:
      abi: "function call(address addr, bytes calldata data)"
      args:
        - "0x{ref:token-faucet.TokenFaucet}"
        - abi: "function requestToken(address token, uint256 amount)"
          args:
            - "0x{ref:tether.TetherToken}"
            - "1000000000000" # 1000000 USDT
  - # provide liquidity for pool via PoolLiquidityProvider
    action: "call"
    address: "0x{create:1}"
    amount: "0x{ether:1050}" # 1050 ETH
    call:
      abi: "function provideLiquidity(address token0, address token1, uint24 fee, int24 tickLower, int24 tickUpper, uint256 amount0Desired, uint256 amount1Desired)"
      args:
        - "0x{ref:weth9.WETH9}"
        - "0x{ref:tether.TetherToken}"
        - "3000"
        - "-237240"
        - "-177240"
        - "1000212926910446182937" # 1000 ETH
        - "1000000000000" # 1000000 USDT

  # USDC/WETH pool
  - # create & init pool
    action: "call"
    address: "0x{ref:uniswap-v3.NonfungiblePositionManager}"
    amount: 0
    data: "0x13ead5620000000000000000000000002ce89a6c99b45d1b62c1c07caf731bf12d88c293000000000000000000000000675d653afc71a433ca5586ed4d52e64b5fffe7870000000000000000000000000000000000000000000000000000000000000bb800000000000000000000000000000000000000000002128422b231dc1486f5f3"
  - # request 1,000,000 USDC as PoolLiquidityProvider from TokenFaucet
    action: "call"
    address: "0x64deF03639e9cC87c93d266c90010D17616F7318"
    amount: "0x{ether:10000}" # 10000 ETH
    data: "0x1b8b921d000000000000000000000000746789e5b988e9da56552fe6de6ec671c01a2336000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000441c11fce2000000000000000000000000675d653afc71a433ca5586ed4d52e64b5fffe787000000000000000000000000000000000000000000000000000000e8d4a5100000000000000000000000000000000000000000000000000000000000"
  - # provide liquidity for pool via PoolLiquidityProvider
    action: "call"
    address: "0x64deF03639e9cC87c93d266c90010D17616F7318"
    amount: "0x{ether:1050}" # 1050 ETH
    data: "0xdd1427770000000000000000000000002ce89a6c99b45d1b62c1c07caf731bf12d88c293000000000000000000000000675d653afc71a433ca5586ed4d52e64b5fffe7870000000000000000000000000000000000000000000000000000000000000bb8fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc6148fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd4ba800000000000000000000000000000000000000000000003638be25ab7ae42219000000000000000000000000000000000000000000000000000000e8d4a51000"

  # USDC/USDT pool
  - # create & init pool
    action: "call"
    address: "0x{ref:uniswap-v3.NonfungiblePositionManager}"
    amount: 0
    data: "0x13ead562000000000000000000000000675d653afc71a433ca5586ed4d52e64b5fffe7870000000000000000000000009dd32d4f511996efff334b6f4c1229757b963aa200000000000000000000000000000000000000000000000000000000000001f40000000000000000000000000000000000000001000000000000000000000000"
  - # request 1,000,000 USDT as PoolLiquidityProvider from TokenFaucet
    action: "call"
    address: "0x64deF03639e9cC87c93d266c90010D17616F7318"
    amount: "10000000000000000000000" # 10000 ETH
    data: "0x1b8b921d000000000000000000000000746789e5b988e9da56552fe6de6ec671c01a2336000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000441c11fce20000000000000000000000009dd32d4f511996efff334b6f4c1229757b963aa2000000000000000000000000000000000000000000000000000000e8d4a5100000000000000000000000000000000000000000000000000000000000"
  - # request 1,000,000 USDC as PoolLiquidityProvider from TokenFaucet
    action: "call"
    address: "0x64deF03639e9cC87c93d266c90010D17616F7318"
    amount: "10000000000000000000000" # 10000 ETH
    data: "0x1b8b921d000000000000000000000000746789e5b988e9da56552fe6de6ec671c01a2336000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000441c11fce2000000000000000000000000675d653afc71a433ca5586ed4d52e64b5fffe787000000000000000000000000000000000000000000000000000000e8d4a5100000000000000000000000000000000000000000000000000000000000"
  - # provide liquidity for pool via PoolLiquidityProvider
    action: "call"
    address: "0x64deF03639e9cC87c93d266c90010D17616F7318"
    amount: 0
    data: "0xdd142777000000000000000000000000675d653afc71a433ca5586ed4d52e64b5fffe7870000000000000000000000009dd32d4f511996efff334b6f4c1229757b963aa200000000000000000000000000000000000000000000000000000000000001f4ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe4ee0000000000000000000000000000000000000000000000000000000000001b12000000000000000000000000000000000000000000000000000000e8d4a50fff000000000000000000000000000000000000000000000000000000e8d4a50fff"


code-verify:
  "0x64deF03639e9cC87c93d266c90010D17616F7318": # PoolLiquidityProvider
    input: "code-input-01.json"
    compiler: "v0.8.17+commit.8df45f5f"
    contract: "PoolLiquidityProvider"
  "0xb18DF43ee8Ad87554acdBD2532a8079b3747fbef": # UniswapV3Pool USDT/WETH
    input: "code-input-02.json"
    compiler: "v0.7.6+commit.7338295f"
    contract: "UniswapV3Pool"
  "0x5d0BF1419bC639F51C658274d2c5a717747cC6c4": # UniswapV3Pool USDC/WETH
    input: "code-input-02.json"
    compiler: "v0.7.6+commit.7338295f"
    contract: "UniswapV3Pool"
  "0x26b5335d9F637571B8D45C7ED8d206d088379351": # UniswapV3Pool USDC/USDT
    input: "code-input-02.json"
    compiler: "v0.7.6+commit.7338295f"
    contract: "UniswapV3Pool"